# malwaresandbox/runner.py
import subprocess
import time
import psutil
from .monitor_process import monitor_processes
from .monitor_files import monitor_files
from .monitor_network import monitor_network
from .report import save_report

def run_file(file_path):
    print(f"[*] Running suspicious file: {file_path}")
    proc = subprocess.Popen([file_path], shell=True)

    time.sleep(2)  # give it a moment to start

    logs = {
        "processes": monitor_processes(proc.pid),
        "files": monitor_files(),
        "network": monitor_network()
    }

    save_report(logs)

    try:
        proc.terminate()
    except Exception:
        pass
